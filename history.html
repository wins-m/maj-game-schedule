<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>历史记录 - 麻将比赛管理系统</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/history.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>历史记录</h1>
                <div class="header-actions">
                    <a href="index.html" class="btn btn-secondary">返回主页</a>
                    <button id="export-history-btn" class="btn btn-secondary">导出历史</button>
                    <button id="import-history-btn" class="btn btn-warning">导入历史</button>
                </div>
            </div>
            <input type="file" id="import-file-input" accept=".json" style="display: none;">
        </header>

        <main>
            <div id="loading-message" class="loading-message">
                <p>正在加载数据...</p>
            </div>

            <div id="error-message" class="error-message" style="display: none;">
                <p>加载失败，请检查服务器连接</p>
                <button onclick="location.reload()" class="btn btn-primary">重新加载</button>
            </div>

            <div id="history-content" style="display: none;">
                <div class="history-filters">
                    <div class="filter-group">
                        <label for="round-filter">场次筛选:</label>
                        <select id="round-filter">
                            <option value="">全部场次</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="table-filter">桌次筛选:</label>
                        <select id="table-filter">
                            <option value="">全部桌次</option>
                            <option value="1">第1桌</option>
                            <option value="2">第2桌</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="player-filter">选手筛选:</label>
                        <select id="player-filter">
                            <option value="">全部选手</option>
                        </select>
                    </div>
                </div>

                <div class="history-table-container">
                    <table id="history-table" class="history-table">
                        <thead>
                            <tr>
                                <th>桌次</th>
                                <th>选手姓名</th>
                                <th>积分</th>
                                <th>评分</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="history-tbody">
                            <!-- 历史记录将在这里动态生成 -->
                        </tbody>
                    </table>
                </div>

                <div id="no-data" class="no-data" style="display: none;">
                    <p>暂无历史记录</p>
                </div>
            </div>
        </main>
    </div>

    <!-- 编辑对话框 -->
    <div id="edit-dialog" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>编辑历史记录</h3>
            <form id="edit-form">
                <div class="edit-info">
                    <p id="edit-info-text"></p>
                </div>

                <div id="edit-players-container">
                    <!-- 选手编辑区域将在这里动态生成 -->
                </div>

                <div class="record-url-edit">
                    <label>牌谱网址:</label>
                    <input type="url" id="edit-record-url" placeholder="https://..." maxlength="500">
                </div>

                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">保存</button>
                    <button type="button" class="btn btn-secondary" id="cancel-edit-btn">取消</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/storage-api.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/game.js"></script>
    <script src="js/history.js"></script>
</body>
</html>
